<div class="selion-content-div">
  <h1 id="getting-started-with-seLion" class="page-header">Excel DataProvider</h1>
  <p class="lead">
    Excel DataProvider is an implementation of SeLion DataProvider that operates on Microsoft Excel files
  </p>
  <p>
    Excel formats data in rows and columns (tabular form). We shall look at a various examples on how to use
    SeLionDataProvider over Excel files.
  </p>

  <h2>Simple Case</h2>
  <p>First create an Excel sheet similar to the following sample:</p>
  <div class="container">
    <img src="../images/exceldataprovider-simple.jpg" alt="View of the Excelsheet">
  </div>
  <br>
  <p>The first represents the variable names. The following rows contain the values of those variables.</p>
  <p>
    The first column i.e., <em>RowNumber</em>, is compulsory but does not contain actual test data. It merely stores
    the keys that is used to identify a specific row from the Excel sheet. The title can be anything you choose.
  </p>
  <p>To read from the Excel sheet you need to define a <code>@DataProvider</code>.</p>
  <p>The <code>@DataProvider</code> looks like the following:</p>
  <pre data-src="../sample-files/excelDataProviderSimple.java"></pre>
  <p>Lets go through the above code in detail.</p>
  <ul>
    <li>
      We first instantiate a <code>FileSystemResource</code>, which is an implementation of the abstract
      <code>DataResource</code>, with the path to the Excel file and a class template to hold the read data. Here the
      template is of the class named <code>SimpleData</code>. The code for this class is given below.
    </li>
    <li>
      We use the <code>DataResource</code> created in a step above as a parameter to the factory
      <code>DataProviderFactory</code> to create a <code>SeLionDataProvider</code>.
    </li>
    <li>
      The final step is to use the method <code>getAllData</code> of <code>SeLionDataProvider</code>
      to return the two dimensional object array consumed by the <samp>Test</samp> method.
    </li>
  </ul>
  <p>The <samp>SimpleData</samp> class looks like the following:</p>
  <pre data-src="../sample-files/excelDataProviderSimpleObject.java"></pre>
  <p>Note that the variable definitions following the  exact name and order as in the Excel sheet.</p>
  <p>A typical <samp>Test</samp> method using the <samp>DataProvider</samp> will be as follows:</p>
  <pre data-src="../sample-files/excelDataProviderSimpleTest.java"></pre>

  <h2>Getting Specific Parts of the Data</h2>
  <h4>By Indices</h4>
  <p>
    The underlying implementation of a <samp>SeLionDataProvider</samp> while retrieving it from the
    <samp>DataProviderFactory</samp> using an Excel file is essentially a <samp>ExcelDataProvider</samp>. This mechanism
    provides us the capability to use the specific methods of ExcelDataProvider.
  </p>
  <p>We can retrieve specific rows from the Excel sheet after proper casting for the resultant SeLionDataProvider</p>
  <p>Lets consider the same Excel sheet as shown above where the first column represent the keys to identify rows.</p>
  <p>We use the <code>getSingleExcelRow</code> of <code>ExcelDataProvider</code> to access a single row.</p>
  <p>The <code>@DataProvider</code> looks like the following:</p>
  <pre data-src="../sample-files/excelDataProviderSpecificIndex.java"></pre>
  <p>
    In this case we asked for the row with the key 2 and stored its values in the object <code>SimpleData</code>. We
    then created the <code>Object[][]</code> that is the return type of the DataProvider method.
  </p>
  <p>Note that Strings can also be used as indices and if integer is used as indices it starts from 1 and not 0.</p>
  <p>The <samp>Test</samp> method remains the same.</p>
  <p>Another way to specify parts of the Excel sheet to be used is to provide ranges of the parts we want to load.</p>
  <p>The <code>@DataProvider</code> looks like the following:</p>
  <pre data-src="../sample-files/excelDataProviderIndexed.java"></pre>
  <p>The <samp>Test</samp> method remains the same.</p>
  <p>The second method allows us to specify a int array containing the keys that we want to be included.</p>
  <p>The <code>@DataProvider</code> will change as follows:</p>
  <pre data-src="../sample-files/excelDataProviderIndexes.java"></pre>
  <p>The <samp>Test</samp> method remains the same.</p>
  <p>In this case the <code>ExcelDataprovider</code> will go through all the rows and return only the ones which have 
    keys in the array of keys that we have provided i.e. rows 1, and 2
  </p>

  <h2>Using CustomTypes in Excel</h2>
  <p>
    Specific columns in the Excel sheet can be mapped to custom types using <code>DefaultCustomType</code>.
  </p>
  <p>Consider the Excel sheet given below:</p>
  <div class="container">
    <img src="../images/exceldataprovider-custom.jpg" alt="View of the Excelsheet">
  </div>
  <p>
    If you want to map the Country column to a custom <code>Country</code> you would need to map the accessor method 
    of the parent class to the custom type as shown below.
  </p>
  <p>The <code>@DataProvider</code> will change as follows:</p>
  <pre data-src="../sample-files/excelDataProviderCustom.java"></pre>
  <p>A typical <samp>Test</samp> method using the <samp>DataProvider</samp> will be as follows:</p>
  <pre data-src="../sample-files/excelDataProviderCustomTest.java"></pre>
  <p>Code for <code>CustomData</code> will be as follows:</p>
  <pre data-src="../sample-files/excelDataProviderCustomObject.java"></pre>
  <p>Code for <code>Country</code> will be as follows:</p>
  <pre data-src="../sample-files/excelDataProviderCountryObject.java"></pre>
</div>

<script src="../js/prismjs-min.js"></script>