<div class="selion-content-div">
  <h1 class="page-header">Using YamlDataProvider to Run Data Driven Tests</h1>

  <p>TestNG provides us with the <code>@DataProvider</code> annotation</p>

  <p>This is extremely useful when we have several test cases that have the same logic but need to be run for different
    data. </p>

  <p>The dataprovider support in TestNG is generic and versatile enough to allow us to plug in any sort of data
    source/generator.</p>

  <p>To learn more about the TesNG data providers please refer <a
      href="http://testng.org/doc/documentation-main.html#parameters-dataproviders">TestNG DataProviders</a></p>

  <p>In Selion we provide a YamlDataProvider class that makes it easy to provide the test data in a <code>.yaml</code>
    file. To find out more about the YAML file format please refer to <a href="http://www.yaml.org/start.html">Getting
      started with Yaml</a>. YAML provides a convenient alternative to xml files and is more human readable.</p>

  <h2>Simple Case</h2>

  <p>Lets start with the a simple case. We have to run a test case with 4 times with different string inputs. In this
    case the YAML file will look as follows</p>
  <pre data-src="../sample-files/basicYaml.yaml" class="language-markup"></pre>
  <p>The DataProvider will look as follows :</p>
  <pre data-src="../sample-files/yamlDataProviderSample1.java"></pre>
  <p>The test method will look as follows</p>
  <pre data-src="../sample-files/yamlDataProviderTestMethod1.java"></pre>
  <p>In this case the test method will be invoked four times, once with each of the strings. the variable
    <code>testdata</code> will contain the string the method is invoked with.</p>

  <h2>Passing Objects</h2>

  <p>That was simple enough but what if we want to pass a more complex object? That takes a little more effort.</p>

  <p>Lets say we want to pass an object of class MyObject to the test method. For this <code>MyObject</code> has to be a
    JavaBean. As an example we have the following MyObject class</p>
  <pre data-src="../sample-files/yamlMyObjectClass.java"></pre>
  <p>Observe that each of the variables of the object has public getters and setters.</p>

  <p>The corresponding yaml file will look like the following</p>
  <pre data-src="../sample-files/yamlDataProviderSample2.yaml" class="language-markup"></pre>
  <p>This might need a little further explanation</p>
  <ul>
    <li>The line <code>- !!package.OtherDataSheet</code> tells us that the following lines describe the values/data of
      objects of the class <code>package.Myobject</code></li>
    <li>The line <code>testcaseid : testcaseid1</code> tells us that the variable <code>testcaseid</code> has the value
      <code>testcaseid1</code></li>
    <li>The line <code>country : country1</code> tells us that the variable <code>country</code> has the value <code>country1</code>
    </li>
  </ul>
  <p>The dataprovider does not change at all. It still looks as follows :</p>
  <pre data-src="../sample-files/yamlDataProviderSample1.java"></pre>
  <p>The Test Method changes slightly. Instead of expecting a String parameter, it now expects an instance of the class
    MyObject

  <p>
  <pre data-src="../sample-files/yamlSampleTestCase.java"></pre>
  <h2>Getting Test Data in a HashMap</h2>

  <p>All this is well and good. But what if we want to provide multiple objects as input instead of defining a complex
    java class?</p>

  <p>In this case YamlDataprovider can be used to return a LinkedhashMap of the values</p>

  <p>The YAML file will look as follows</p>
  <pre data-src="../sample-files/yamlSampleFile.yaml"></pre>
  <p>Here <code>test1</code> and <code>test2</code> are not part of the test data but are keys to identify particular
    parts of the test data.</p>

  <p>The other lines represent the key-value pairs for the test data.</p>

  <p>The DataProvider does not change at all</p>

  <p>The Test Method will look as follows</p>
  <pre data-src="../sample-files/yamlSampleTestCase2.java"></pre>
  <h2>Getting Specific Parts of the Data</h2>

  <p>Now that we know how to get all the data from the YAML files lets look at the ways to get only specific data from
    the file</p>
  <h4>By Keys</h4>

  <p>Remember we had told you that <code>test1</code> and <code>test2</code> were keys used to identify particular parts
    of the test data? This is how we use them.
    <br>We use the <code>getDataByKeys()</code> method to accomplish this.

  <p>The DataProvider changes to look as follows</p>
  <pre data-src="../sample-files/yamlSampleDataProvider.java"></pre>
  <p>Only the entries whose keys are present in the keyArray will be returned and used to kick off the test methods.
    This allows us to maintain a single data file and use parts of it to run our test cases.</p>

  <p>This method can be used return Strings, LinkedHashMaps or user defined objects depending on the yaml file.</p>
  <h4>By Indexes</h4>

  <p>Another way to specify parts of the yaml file to be used is to provide indexes of the parts we want to be used.
    <br>For example we might want entry number 10 to entry number 15 to be run.
    <br>In this case we use the <code>getDataByIndex()</code> method of the YamlDataProvider

  <p>The DataProvider looks as follows :</p>
  <pre data-src="../sample-files/yamlSampleDataProvider2.java"></pre>
  <p>In this case the data at indexes 1,2,3,7,10,11 and 12 will be used to run the test cases</p>

  <h2>Multiple Sources</h2>

  <p>YamlDataProvider also allows us to read data from multiple resources and provide them as two separate parameters to
    the test method.</p>

  <p>The DataProvider will look like the following</p>
  <pre data-src="../sample-files/yamlSampleDataProvider3.java"></pre>
  <p>The corresponding Test method will look as follows</p>
  <pre data-src="../sample-files/yamlSampleTestCase3.java"></pre>
  <h2>Serialization of Java Objects</h2>

  <p>YamlDataProvider also provides methods for serializing the various java objects that we might want. </p>

  <p>The methods <code>serializeObjectToYamlString()</code> <code>serializeObjectToYamlStringAsList()</code> <code>serializeObjectToYamlStringAsDocuments()</code>
    <code>serializeObjectToYamlStringAsMap()</code>can be used to produce the corresponding yaml data to a given java
    object. This can be particularly useful if we are running into issues trying to read data from the yaml files. It
    allows us to see what the yaml file should have looked like and compare it to what it does look like.</p>

  <p>These method while not really necessary from testing logic perpective are extremely useful when writing the test
    cases themselves and while generating the test data</p>
</div>

<script src="../js/prismjs-min.js"></script>
